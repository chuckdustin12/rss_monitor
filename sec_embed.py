from discord_webhook import DiscordEmbed, AsyncDiscordWebhook
from cfg import hex_colors, fudstop
sec_filing_titles = ['Rule 24F-2 notice', 'Securities to be offered to employees in employee benefit plans, post-effective amendments', 'Notice of disclosure filed pursuant to Section 219 of the Iran Threat Reduction and Syria Human Rights Act of 2012 (Exchange Act Section 13(r)).', 'Report of foreign issuer [Rules 13a-16 and 15d-16] - amended', 'Report of proposed sale of securities - amended', 'Form - 424I', 'Automatic shelf registration statement of securities of well-known seasoned issuers', 'Definitive proxy statement relating to merger or acquisition', 'Notice under Exchange Act Rule 12b-25 of inability to timely file Form N-CSR (annual or semi-annual report)', 'Report of proposed sale of securities', 'Prospectus [Rule 424(b)(2)]', 'Preliminary proxy statements relating to merger or acquisition', 'Registration statement [Section 12] or Annual Report [Section 13(a), 15(d)]', 'Annual and transition report of foreign private issuers [Sections 13 or 15(d)]', 'Asset-backed securitizer report pursuant to Section 15G', 'Current report - amended', 'Registration adding securities to prior Form S-3 registration [Rule 462(b)]', 'Certification of no change in definitive materials', 'Tender offer statement by Issuer', 'Initial statement of beneficial ownership of securities', 'Tender offer statement by Issuer - amended', 'Prospectuses and communications, business combinations', 'Securities registration termination [Section 12(g)]', 'Annual report of employee stock purchase, savings and similar plans - amended', 'Post-effective amendment [Rule 485(a)]', 'Certified Shareholder Report', 'Notification of inability to timely file Form 20-F', 'Quarterly report filed by institutional managers, Holdings - amended', 'Other definitive proxy statements', 'General form for registration of securities under the Securities Act of 1933 - amended', 'Notice under Exchange Act Rule 12b-25 of inability to timely file Form N-CSR (annual or semi-annual report) - amended', 'Quarterly report [Sections 13 or 15(d)] - amended', 'Registration statement for closed-end investment companies - amended', 'Definitive proxy statement, contested solicitations', 'Registration of securities [Section 12(b)] - amended', 'Registration of securities [Section 12(b)]', 'Tender Offer/Rights Offering Notification Form', 'Voluntary Supplemental Material by Foreign Issuers [Section 11(a)]', 'Quarterly report filed by institutional managers, Notice', 'Certified Shareholder Report, Semi-Annual - amended', 'Notice of Exempt Offering of Securities', 'Annual Report to Security Holders - amended', 'Certified Shareholder Report, Semi-Annual', 'Withdrawal of an Application for exemption [Section 12(g)] or from filing certain reports [Section 13(a)]', 'Registration of securities, business combinations - amended', 'Certificate of accounting of securities in custody of management investment companies [Rule 17f-2]', 'Notification of inability to timely file Form 10-K 405, 10-K, 10-KSB 405, 10-KSB, 10-KT, or 10-KT405', 'Certified Shareholder Report - amended', 'Notification filed by national security exchange to report the removal from listing and registration of matured, redeemed or retired securities', 'Initial statement of beneficial ownership of securities - amended', 'Prospectus [Rule 424(b)(4)]', 'Summary Prospectus for certain open-end management investment companies filed pursuant to Securities Act Rule 497(K)', 'Registration of securities, foreign private issuers, business combinations - amended', 'Post-effective Amendment to an automatic shelf registration statement', 'Registration of securities [Section 12(g)]', 'Registration statement by foreign private issuers - amended', 'Registration Withdrawal Request', 'Registration statement for closed-end investment companies', 'Form - CERT', 'Application for exemption and other relief filed under the Investment Company Act of 1940', 'Transition report [Rule 13a-10 or 15d-10]', 'Annual report [Section 13 and 15(d), not S-K Item 405] - amended', 'Annual Report for Registered Investment Companies', 'Securities to be offered to employees in employee benefit plans', 'Annual Report to Security Holders', 'Revised definitive proxy soliciting materials', 'Registration of securities, foreign private issuers, business combinations', 'Tender offer statement by Third Party', 'Notice of Exempt Offering of Securities - amended', 'Preliminary Proxy Soliciting materials', 'Registration statement for closed-end investment company (business combinations)', 'Non-management revised preliminary proxy soliciting materials, contested and otherwise', 'Post-effective amendment [Rule 485(b)]', 'Notice of Effectiveness', 'Form - N-2ASR', 'Annual Report of proxy voting record of management investment companies', 'Periodic and interim reports mailed to shareholders', 'Registration of securities issued by real estate companies - amended', 'Correspondence', 'Registration of securities, business combinations', 'Fidelity Bond [Rule 17G-1(g)] - amended', 'Registration statement for certain foreign private issuers', 'Statement of changes in beneficial ownership of securities - amended', 'Post-effective amendment adding exhibits to registration statement [Rule 462(d)]', 'Statement of acquisition of beneficial ownership by individuals', 'Statement of acquisition of beneficial ownership by individuals - amended', 'Fidelity Bond [Rule 17G-1(g)]', 'Annual report [Section 13 and 15(d), not S-K Item 405]', 'Draft Registration Statement - amended', 'Prospectus [Rule 424(b)(3)]', 'Notification of inability to timely file Form 10-Q or 10-QSB - amended', 'Current report', 'Monthly Portfolio Investments Report on Form N-PORT (Public) - amended', 'Annual Report of proxy voting record of management investment companies - amended', 'Registration adding securities to prior Form S-1 registration [Rule 462(b)]', 'SEC-generated letter', 'Annual statement of changes in beneficial ownership of securities - amended', 'Solicitation, recommendation statements - amended', 'Solicitation, recommendation statements', 'Application for exemption and other relief filed under the Investment Company Act of 1940 - amended', 'Quarterly report [Sections 13 or 15(d)]', 'Registration statement under Securities Act of 1933', 'Other definitive information statements', 'Other preliminary proxy statements', 'General form for registration of securities under the Securities Act of 1933', 'New effective date for post-effective amendment [Rule 485(b)(1)(iii)]', 'General statement of acquisition of beneficial ownership - amended', 'SEC Staff Letter', 'Amendment Withdrawal Request', 'Form - SPDSCL', 'Going private transaction by certain issuers - amended', 'Registration statement for certain foreign private issuers - amended', 'Filing by certain investment companies of Rule 482 advertising [Rule 497 and 482(c)]', 'Prospectus [Rule 424(b)(7)]', 'Post-effective amendments for immediately effective filing', 'Annual and transition report of foreign private issuers [Sections 13 or 15(d)] - amended', 'Prospectus [Rule 424(b)(5)]', 'Designates a U.S. agent for service of process by foreign banks and foreign insurance companies', 'Other preliminary information statements', 'Prospectus [Rule 424(b)(1)]', 'Additional definitive proxy soliciting materials filed by non-management and Rule 14(a)(12) material', 'Appointment of Agent for Service of Process and Undertaking', 'Registration statement [Section 12] or Annual Report [Section 13(a), 15(d)] - amended', 'Form - SD', 'Monthly Portfolio Investments Report on Form N-PORT (Public)', 'Draft Registration Statement', 'Written communication relating to third party tender offer', 'Written communication relating to an issuer or third party', 'Notification of inability to timely file Form 10-Q or 10-QSB', 'Notice of exempt solicitation submitted by non-management', 'General statement of acquisition of beneficial ownership', 'Report of foreign issuer [Rules 13a-16 and 15d-16]', 'Registration statement by foreign private issuers', 'Statement of changes in beneficial ownership of securities', 'Filing under Securities Act Rules 163/433 of free writing prospectuses', 'Registration Statement for Securities of certain Canadian Issuers.', 'Confidential treatment order', 'Definitive materials', 'Post-Effective amendments for registration statement', 'Notification of the removal from listing and registration of matured, redeemed or retired securities', 'Annual statement of changes in beneficial ownership of securities', 'Asset-Backed Issuer Distribution Report [Section 13 or 15(d) of the Securities Exchange Act of 1934]', 'Going private transaction by certain issuers', 'Quarterly report filed by institutional managers, Holdings', 'Notice by closed-end investment companies of intent to purchase their own securities', 'Annual Report for Registered Investment Companies - amended', 'Registration statement under Securities Act of 1933 - amended', 'Registration Statement for Securities of certain Canadian Issuers. - amended', 'Additional definitive proxy soliciting materials and Rule 14(a)(12) material', 'Annual report of employee stock purchase, savings and similar plans', 'Tender offer statement by Third Party - amended']







NPORT_DESC = f"""```py\nThe N-PORT form is a filing requirement for registered investment companies (including mutual funds, exchange-traded funds, and closed-end funds) in the United States under the Investment Company Act of 1940. The form is filed with the U.S. Securities and Exchange Commission (SEC) and is part of the modernization of investment company reporting.```

**What It Contains:**\n
\n> The N-PORT form requires detailed portfolio-level information about the fund's investments, including:

```py\nGeneral Information: Basic details about the registrant and series.\n
Investment Data: A comprehensive list of all portfolio investments, including asset types, issuers, and other relevant details.\n
Asset and Liability Details: Information about assets, liabilities, and net assets.\n
Risk Metrics: Various risk metrics related to the portfolio, such as Value at Risk (VaR).\n
Derivatives Information: Information about derivative instruments in the portfolio.\n
Securities Lending: Information regarding securities lending activities, if applicable.\n
Miscellaneous: Any other required information, such as explanatory notes.```"""


async def send_sec_embed(webhook_url, title, ticker, subtitle, name, updated, filing_date, acceptance_date_time, filing_href, form_name, size, confirmed_name, employer_identification_number, fiscal_year_end, office,state_of_incorporation, state_location, state_location_href, email, street1, city, stateOrCountry, stateOrCountryDescription, zipCode, assigned_sic_href):
    if 'N-PORT' in title:
        description = NPORT_DESC
    else:
        description = f"```py\n{title} | {subtitle} | {name}```\n> Updated: **{updated}**"
    
    embed = DiscordEmbed(title=f"{ticker} - Company Filing", description=description, color=hex_colors['chocolate'])
    embed.add_embed_field(name=f"Company:", value=f"> Name: **{confirmed_name}**\n> EIN Number: **{employer_identification_number}**\n> Fiscal End: **{fiscal_year_end}**\n> Office: **{office}**\n> State of Incorp: **{state_of_incorporation}**", inline=False)
    embed.add_embed_field(name=f"Filing Info:", value=f"> **{filing_date}**\n> Accepted: **{acceptance_date_time}**\n> Link: {filing_href}\n> Form Name: **{form_name}**\n> Size: **{size}**", inline=False)

    embed.add_embed_field(name=f"State Location:", value=f"> **{state_location}**\n> Link: {state_location_href}")
    embed.add_embed_field(name=f'Author Info:', value=f"> EMAIL: **{email}**\n> Street1: **{street1}**\n> City: **{city}**\n> State: **{stateOrCountry}**\n> Zip: **{zipCode}**", inline=False)
    embed.add_embed_field(name=f"SIC:", value=f"> Link: **{assigned_sic_href}**")
    embed.set_timestamp()
    embed.set_footer(text=f"Implemented by FUDSTOP", icon_url = fudstop)

    hook = AsyncDiscordWebhook(webhook_url, content=f"<@375862240601047070>")
    hook.add_embed(embed)
    await hook.execute()
